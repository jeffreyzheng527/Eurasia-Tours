<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Spain & Portugal In-Depth Tour (11 Days) - Eurasia Tours</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; }
        h1, h2, h3, h4, h5 { font-family: 'Playfair Display', serif; }
        
        .text-brand { color: #b91c1c; }
        .bg-brand { background-color: #b91c1c; }
        .border-brand { border-color: #b91c1c; }
        .hover\:bg-brand:hover { background-color: #991b1b; }
        
        .nav-item {
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 13px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #374151;
        }

        /* Animations */
        .mobile-menu-enter-active, .mobile-menu-leave-active { transition: opacity 0.3s ease, transform 0.3s ease; }
        .mobile-menu-enter-from, .mobile-menu-leave-to { opacity: 0; transform: translateY(-10px); }
        
        .dropdown-enter-active { transition: opacity 0.2s ease-out, transform 0.2s ease-out; }
        .dropdown-leave-active { transition: opacity 0.15s ease-in, transform 0.15s ease-in; }
        .dropdown-enter-from, .dropdown-leave-to { opacity: 0; transform: translateY(10px) scale(0.98); }
        
        /* Modal Animations */
        .modal-enter-active, .modal-leave-active { transition: opacity 0.3s ease; }
        .modal-enter-from, .modal-leave-to { opacity: 0; }
        .modal-content-enter-active { transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); } 
        .modal-content-leave-active { transition: all 0.2s ease-in; }
        .modal-content-enter-from, .modal-content-leave-to { transform: scale(0.95); opacity: 0; }

        .qr-fade-enter-active, .qr-fade-leave-active { transition: opacity 0.3s ease, transform 0.3s ease; }
        .qr-fade-enter-from, .qr-fade-leave-to { opacity: 0; transform: translateY(10px); }
        
        /* Carousel */
        .carousel-enter-active, .carousel-leave-active { transition: opacity 1s ease; }
        .carousel-enter-from, .carousel-leave-to { opacity: 0; }

        /* Timeline */
        .timeline-line {
            position: absolute;
            left: 15px;
            top: 40px;
            bottom: 0;
            width: 2px;
            background-color: #e5e7eb;
        }
        .last-item .timeline-line { display: none; }
        
        /* Form Highlight */
        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 0 rgba(185, 28, 28, 0); border-color: #e5e7eb; }
            50% { box-shadow: 0 0 20px 0 rgba(185, 28, 28, 0.3); border-color: #b91c1c; background-color: #fff1f2; }
            100% { box-shadow: 0 0 0 0 rgba(185, 28, 28, 0); border-color: #e5e7eb; background-color: white; }
        }
        .highlight-active { animation: highlightPulse 1.5s ease-in-out 2; }
        
        .input-error { 
            border-color: #ef4444 !important;
            background-color: #fef2f2 !important; 
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom Scrollbar */
        .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: #d1d5db transparent;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #d1d5db; border-radius: 20px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background-color: #9ca3af; }
        
        /* Accordion */
        .accordion-enter-active, .accordion-leave-active { transition: all 0.3s ease-in-out; max-height: 500px; opacity: 1; overflow: hidden; }
        .accordion-enter-from, .accordion-leave-to { max-height: 0; opacity: 0; }

        [v-cloak] { display: none; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 antialiased">

<div id="app" v-cloak>
    <header class="fixed w-full top-0 z-[100] bg-white/95 backdrop-blur-md shadow-[0_2px_15px_rgba(0,0,0,0.05)] border-b border-gray-100 transition-all duration-300">
        <div class="container mx-auto px-6 lg:px-12">
            <div class="flex flex-col lg:flex-row items-center justify-between h-auto lg:h-24 py-3 lg:py-0">
                
                <div class="flex items-center justify-between w-full lg:w-auto">
                    <a href="index-en.html" class="flex items-center group">
                        <img src="https://www.eurasia-tours.fr/assets/logo-word-rNz8dsz6.jpg" 
                             alt="Eurasia Tours Logo" class="h-10 lg:h-12 w-auto object-contain transition-transform group-hover:scale-105 mix-blend-multiply">
                    </a>
                    <button class="lg:hidden relative z-50 text-2xl p-2 text-gray-700 focus:outline-none cursor-pointer hover:text-brand transition" @click="isMobileMenuOpen = !isMobileMenuOpen">
                        <i class="fas" :class="isMobileMenuOpen ? 'fa-times' : 'fa-bars'"></i>
                    </button>
                </div>

                <nav class="hidden lg:flex flex-1 items-center justify-end pl-12 gap-10">
                    <div v-for="link in navLinks" :key="link.name" class="relative group h-24 flex items-center"
                         @mouseenter="link.name === 'Destinations' ? isDestDropdownOpen = true : null"
                         @mouseleave="isDestDropdownOpen = false">
                        
                        <a :href="link.url" class="nav-item relative py-2 hover:text-brand transition-colors flex items-center gap-1 group" :class="{'text-brand': link.name === 'Destinations'}">
                            {{ link.name }}
                            <i v-if="link.subLinks" class="fas fa-chevron-down text-[9px] opacity-50 transition-transform duration-300 ml-1" :class="{'rotate-180': link.name === 'Destinations' && isDestDropdownOpen}"></i>
                            <span class="absolute bottom-0 left-0 h-[2px] bg-brand transition-all duration-300 opacity-0 group-hover:opacity-100" :class="link.name === 'Destinations' ? 'w-full opacity-100' : 'w-0 group-hover:w-full'"></span>
                        </a>

                        <transition name="dropdown">
                            <div v-if="link.name === 'Destinations' && isDestDropdownOpen" 
                                 class="absolute top-[80%] left-1/2 -translate-x-1/2 w-[240px] bg-white shadow-[0_10px_40px_rgba(0,0,0,0.1)] rounded-sm border-t-2 border-brand p-0 overflow-hidden">
                                <div class="px-6 py-3 bg-gray-50 border-b border-gray-100 text-[10px] uppercase tracking-[0.2em] text-gray-400 font-bold">Select Region</div>
                                <ul class="py-2">
                                    <li v-for="sub in link.subLinks" :key="sub.name">
                                        <a :href="sub.url" class="flex items-center justify-between px-6 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-brand transition-all group/item">
                                            <span>{{ sub.name }}</span>
                                            <i class="fas fa-arrow-right text-[10px] opacity-0 -translate-x-2 group-hover/item:opacity-100 group-hover/item:translate-x-0 transition-all text-brand"></i>
                                        </a>
                                    </li>
                                </ul>
                                <div class="bg-gray-50 p-3 text-center border-t border-gray-100">
                                    <a href="destination-europe-en.html" class="text-[11px] font-bold uppercase tracking-widest text-brand hover:underline">All Destinations</a>
                                </div>
                            </div>
                        </transition>
                    </div>

                    <div class="relative group h-24 flex items-center pl-6 ml-4 border-l border-gray-200"
                         @mouseenter="isLangDropdownOpen = true"
                         @mouseleave="isLangDropdownOpen = false">
                        
                        <a href="#" class="nav-item hover:text-brand transition-colors flex items-center gap-2">
                            <i class="fas fa-globe text-gray-400 text-lg"></i>
                            {{ currentLang }}
                        </a>
                        
                        <transition name="dropdown">
                            <div v-if="isLangDropdownOpen" 
                                 class="absolute top-[80%] right-0 w-[160px] bg-white shadow-[0_10px_40px_rgba(0,0,0,0.1)] rounded-sm border-t-2 border-brand p-1">
                                <ul class="space-y-0.5">
                                    <li v-for="lang in ['ä¸­æ–‡', 'English', 'FranÃ§aise']" :key="lang">
                                        <a href="#" @click.prevent="switchLang(lang)" 
                                           class="flex items-center justify-between px-4 py-2.5 text-xs font-medium text-gray-600 hover:bg-gray-50 hover:text-brand transition-all"
                                           :class="{'text-brand bg-red-50/50': currentLang === lang}">
                                            {{ lang }}
                                            <i v-if="currentLang === lang" class="fas fa-check text-[10px]"></i>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </transition>
                    </div>
                </nav>
            </div>
        </div>

        <transition name="mobile-menu">
            <nav v-if="isMobileMenuOpen" class="lg:hidden absolute top-full left-0 w-full bg-white border-t border-gray-100 py-8 shadow-2xl h-screen overflow-y-auto">
                <div class="flex flex-col items-center gap-8 px-6">
                    <a v-for="link in navLinks" :key="link.name" :href="link.url"
                       class="text-lg font-medium uppercase tracking-[0.2em] text-gray-800 hover:text-brand transition"
                       @click="isMobileMenuOpen = false">
                       {{ link.name }}
                    </a>
                    
                    <div class="w-16 h-px bg-gray-200 my-2"></div>

                    <div class="flex flex-col items-center gap-4 w-full">
                        <span class="text-xs text-gray-400 uppercase tracking-widest">Select Language</span>
                        <div class="flex gap-3">
                            <button @click="switchLang('ä¸­æ–‡')" class="px-5 py-2 rounded-full text-xs font-bold transition border" :class="currentLang === 'ä¸­æ–‡' ? 'bg-brand text-white border-brand' : 'bg-white text-gray-600 border-gray-200'">ä¸­æ–‡</button>
                            <button @click="switchLang('English')" class="px-5 py-2 rounded-full text-xs font-bold transition border" :class="currentLang === 'English' ? 'bg-brand text-white border-brand' : 'bg-white text-gray-600 border-gray-200'">EN</button>
                            <button @click="switchLang('FranÃ§aise')" class="px-5 py-2 rounded-full text-xs font-bold transition border" :class="currentLang === 'FranÃ§aise' ? 'bg-brand text-white border-brand' : 'bg-white text-gray-600 border-gray-200'">FR</button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

    <main class="pt-24 min-h-screen">
        
        <section class="relative h-[60vh] min-h-[500px] w-full overflow-hidden bg-gray-900 group">
            <transition-group name="carousel">
                <div v-for="(img, index) in heroImages" :key="img" 
                     v-show="currentHeroIndex === index"
                     class="absolute inset-0 w-full h-full will-change-opacity">
                    <img :src="img" 
                         alt="Hero Background" 
                         class="w-full h-full object-cover opacity-90 transition-transform duration-[5000ms] ease-linear transform scale-105">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>
                </div>
            </transition-group>
            
            <button @click="prevSlide" class="absolute left-4 top-1/2 -translate-y-1/2 z-30 w-12 h-12 rounded-full bg-black/30 hover:bg-brand text-white backdrop-blur-sm flex items-center justify-center transition-all opacity-0 group-hover:opacity-100 border border-white/20">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button @click="nextSlide" class="absolute right-4 top-1/2 -translate-y-1/2 z-30 w-12 h-12 rounded-full bg-black/30 hover:bg-brand text-white backdrop-blur-sm flex items-center justify-center transition-all opacity-0 group-hover:opacity-100 border border-white/20">
                <i class="fas fa-chevron-right"></i>
            </button>

            <div class="absolute bottom-8 right-8 z-30 flex gap-2">
                <button v-for="(img, index) in heroImages" :key="index" 
                        @click="currentHeroIndex = index"
                        :class="['h-1.5 rounded-full transition-all', currentHeroIndex === index ? 'bg-brand w-8' : 'bg-white/50 w-2 hover:bg-white']">
                </button>
            </div>

            <div class="absolute bottom-0 left-0 w-full z-20 pt-20 pb-10">
                <div class="container mx-auto px-4 flex flex-col md:flex-row items-end justify-between gap-6">
                    <div class="text-white max-w-3xl">
                        <div class="flex items-center gap-3 mb-3">
                            <span class="bg-brand text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-widest">Iberian Peninsula</span>
                            <span class="bg-white/20 backdrop-blur text-white text-xs font-bold px-3 py-1 rounded-full"><i class="far fa-clock mr-1"></i> 11 Days / 10 Nights</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold font-serif mb-2 leading-tight">
                            {{ tour.title }}
                        </h1>
                        <p class="text-xl md:text-2xl font-light opacity-90 font-serif italic">{{ tour.subTitle }}</p>
                    </div>
                    
                    <div class="hidden md:block text-right pb-2">
                        <div class="text-gray-300 text-sm mb-1 font-medium uppercase tracking-widest">Price / Person (Double Room)</div>
                        <div class="flex items-baseline justify-end gap-1 mb-4">
                            <span class="text-2xl font-bold text-brand">â‚¬</span>
                            <span class="text-5xl font-bold text-white shadow-black drop-shadow-lg">1 295</span>
                        </div>
                        <button @click="handleBookingScroll()" class="bg-brand text-white text-lg px-10 py-4 rounded-full font-bold shadow-[0_10px_20px_rgba(185,28,28,0.4)] hover:-translate-y-1 hover:shadow-2xl transition-all flex items-center gap-2">
                            <span>Get Quote / Book Now</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <div id="sticky-nav" class="sticky top-[80px] lg:top-[96px] z-40 bg-white/95 backdrop-blur shadow-md border-b border-gray-100 transition-all">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between overflow-x-auto scrollbar-hide">
                    <ul class="flex items-center gap-6 md:gap-8 h-14 whitespace-nowrap">
                        <li v-for="item in subMenu" :key="item.id">
                            <a :href="'#' + item.id" 
                               v-if="!item.hidden"
                               class="text-sm font-bold uppercase tracking-wider py-4 border-b-2 border-transparent hover:text-brand hover:border-brand transition-colors block"
                               :class="activeSection === item.id ? 'text-brand border-brand' : 'text-gray-500'">
                                {{ item.name }}
                            </a>
                        </li>
                    </ul>
                    <div class="md:hidden pl-4 border-l border-gray-100 ml-4 py-2">
                        <button @click="handleBookingScroll()" class="bg-brand text-white text-xs px-4 py-2 rounded-full font-bold whitespace-nowrap">
                            Book Now
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="container mx-auto px-4 py-12">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
                
                <div class="lg:col-span-8 space-y-12">
                    
                    <section id="dates" class="scroll-mt-40">
                        <div class="flex items-center gap-3 mb-6">
                            <h2 class="text-3xl font-bold text-gray-800">Dates & Prices</h2>
                            <span class="bg-brand text-white text-xs font-bold px-2 py-1 rounded">2026 Selection</span>
                        </div>
                        
                        <div class="bg-white border border-gray-200 rounded-2xl shadow-lg overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead class="bg-gray-50 border-b border-gray-200">
                                        <tr>
                                            <th class="p-5 font-bold text-gray-600 uppercase text-xs tracking-wider">Departure</th>
                                            <th class="p-5 font-bold text-gray-600 uppercase text-xs tracking-wider">Price (Double Room)</th>
                                            <th class="p-5 font-bold text-brand uppercase text-xs tracking-wider text-right">Single Supp.</th>
                                            <th class="p-5 font-bold text-gray-600 uppercase text-xs tracking-wider text-center">Status</th>
                                            <th class="p-5"></th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-100">
                                        <tr v-for="date in tour.dates" :key="date.start" class="hover:bg-red-50/30 transition-colors group">
                                            <td class="p-5 font-medium text-gray-800">{{ date.start }}</td>
                                            <td class="p-5 text-gray-600">{{ date.price }}</td>
                                            <td class="p-5 text-right font-medium text-gray-500">{{ tour.singleSupplement }}</td>
                                            <td class="p-5 text-center">
                                                <span class="inline-flex items-center gap-1 bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full font-bold">
                                                    <i class="fas fa-check-circle"></i> Confirmed
                                                </span>
                                            </td>
                                            <td class="p-5 text-right">
                                                <button @click="handleBookingScroll(date.start)" class="bg-gray-800 text-white text-xs px-4 py-2 rounded-full font-bold group-hover:bg-brand transition-colors">
                                                    Select
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="bg-gray-50 p-4 text-xs text-gray-500 border-t border-gray-200 flex flex-col md:flex-row justify-between items-center gap-2">
                                <span><i class="fas fa-info-circle mr-1"></i> Single travelers must pay the single supplement (â‚¬650).</span>
                            </div>
                        </div>
                    </section>

                    <section id="overview" class="scroll-mt-40 pt-8 border-t border-gray-100">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                            Highlights
                        </h2>
                        <div class="prose prose-lg text-gray-600 mb-8">
                            <p class="italic text-gray-500 mb-6 border-l-4 border-brand pl-4">
                                "From Gaudi's fantastical architecture to Andalusia's passionate Flamenco, capture the essence of the Iberian Peninsula in one journey."
                            </p>
                            <p class="text-sm">
                                Deeply explore Barcelona's Sagrada Familia and Casa Mila, and feel the royal elegance in Madrid. Visit Cabo da Roca, "Where the land ends and the sea begins," and stroll through Lisbon's BelÃ©m district. Be mesmerized by the magnificence of Seville's Plaza de EspaÃ±a and look up at the Moorish style of the Alhambra Palace in Granada. The itinerary also includes the ancient city of Toledo, the university city of Coimbra, and the cliffside town of Ronda.
                            </p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div v-for="(highlight, index) in tour.highlights" :key="index" class="bg-red-50 p-4 rounded-xl flex items-start gap-3 border border-transparent hover:border-red-100 transition-colors">
                                <div class="w-8 h-8 rounded-full bg-white text-brand flex items-center justify-center flex-shrink-0 shadow-sm mt-1">
                                    <i class="fas fa-check text-sm"></i>
                                </div>
                                <span class="font-medium text-gray-800">{{ highlight }}</span>
                            </div>
                        </div>
                    </section>
                    
                    <section id="map" class="scroll-mt-40">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                            Route Map
                        </h2>
                        <div class="bg-white p-2 rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                            <img src="images/spain-portugal-indepth-tour-11-days/map.jpg" alt="Route Map" class="w-full h-auto object-cover rounded-xl hover:scale-[1.01] transition-transform duration-500">
                        </div>
                    </section>

                    <section id="itinerary" class="scroll-mt-40">
                        <div class="flex items-center justify-between mb-8">
                            <h2 class="text-3xl font-bold text-gray-800">Itinerary</h2>
                            <button @click="toggleAllDays" class="text-brand text-sm font-bold hover:underline px-3 py-1 rounded hover:bg-red-50 transition">
                                {{ isAllExpanded ? 'Collapse All' : 'Expand All' }}
                            </button>
                        </div>

                        <div class="relative space-y-8">
                            <div v-for="(day, index) in tour.daysData" :key="index" 
                                 class="relative pl-10 group" :class="{'last-item': index === tour.daysData.length - 1}">
                                
                                <div class="timeline-line"></div>
                                
                                <div class="absolute left-0 top-0 w-8 h-8 bg-brand text-white rounded-full flex items-center justify-center font-bold text-sm shadow-md z-10">
                                    {{ day.day }}
                                </div>

                                <div class="bg-white border border-gray-100 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow">
                                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4 cursor-pointer select-none" 
                                         @click="toggleDay(index)">
                                        <div>
                                            <div class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-1">
                                                {{ day.transport }}
                                            </div>
                                            <h3 class="text-xl font-bold text-gray-800 group-hover:text-brand transition-colors">
                                                {{ day.title }}
                                            </h3>
                                        </div>
                                    
                                        <i class="fas fa-chevron-down text-gray-300 transition-transform duration-300" 
                                           :class="{'rotate-180': day.isOpen}"></i>
                                    </div>

                                    <div v-show="day.isOpen" class="space-y-4 text-gray-600 leading-relaxed border-t border-gray-50 pt-4">
                                        <div v-html="day.content"></div>
                                         
                                        <div class="mt-4 rounded-xl overflow-hidden h-48 md:h-64 w-full relative bg-gray-100 flex items-center justify-center group/img">
                                            <img :src="day.image" class="w-full h-full object-cover transition-transform duration-700 group-hover/img:scale-105" alt="Day Image">
                                        </div>
                                        
                                        <div class="flex flex-wrap gap-2 mt-4">
                                            <div v-if="day.hotel" class="flex items-center gap-2 text-xs text-gray-500 bg-gray-50 px-3 py-2 rounded-lg">
                                                <i class="fas fa-bed text-brand"></i>
                                                <span class="font-bold">Accommodation:</span> {{ day.hotel }}
                                            </div>
                                            <div v-if="day.meals" class="flex items-center gap-2 text-xs text-gray-500 bg-gray-50 px-3 py-2 rounded-lg">
                                                <i class="fas fa-utensils text-brand"></i>
                                                <span class="font-bold">Meals:</span> {{ day.meals }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="optionals" class="scroll-mt-40">
                        <div class="bg-gradient-to-br from-gray-50 to-white rounded-2xl p-8 border border-gray-200 shadow-sm">
                            <div class="mb-6">
                                <h3 class="text-2xl font-bold text-gray-800 flex items-center gap-3">
                                    <i class="fas fa-ticket-alt text-brand"></i> Optional Excursions
                                </h3>
                                <p class="text-sm text-gray-500 mt-2">Click cards for details. You can select these when booking, and the cost will be added to the estimate (EUR items payable on site).</p>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <div v-for="(item, index) in tour.optionalItems" :key="index" 
                                     @click="openOptionalModal(item)"
                                     class="bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-md transition-all cursor-pointer group flex flex-col transform hover:-translate-y-1">
                                    <div class="h-40 bg-gray-100 relative overflow-hidden">
                                        <img :src="item.detailImage" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                                        <div class="absolute top-2 right-2 bg-brand text-white text-xs font-bold px-2 py-1 rounded shadow-lg">
                                            <span v-if="item.price > 0">{{ item.price }} {{ item.unit }}</span>
                                            <span v-else>Self-pay</span>
                                        </div>
                                        <div class="absolute inset-0 bg-black/10 group-hover:bg-transparent transition-colors"></div>
                                        <div class="absolute bottom-2 left-2 text-white text-xs bg-black/50 px-2 py-1 rounded backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity">
                                            Click for Details
                                        </div>
                                    </div>
                                    <div class="p-4 flex-1 flex flex-col">
                                        <h4 class="font-bold text-gray-800 mb-2 group-hover:text-brand transition-colors">{{ item.name }}</h4>
                                        <p class="text-xs text-gray-500 flex-1 line-clamp-2">{{ item.shortDesc }}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-6 pt-4 border-t border-gray-100 text-xs text-gray-400 flex items-center gap-2">
                                <i class="fas fa-info-circle"></i>
                                <span>Note: Tickets (e.g., Sagrada Familia, Alhambra) should be booked in advance as they may sell out.</span>
                            </div>
                        </div>
                    </section>

                    <section id="includes" class="scroll-mt-40 grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-green-50/50 p-6 rounded-2xl border border-green-100">
                            <h3 class="font-bold text-green-800 mb-4 flex items-center gap-2">
                                <i class="fas fa-check-circle"></i> Included
                            </h3>
                            <ul class="space-y-3">
                                <li v-for="(item, i) in tour.includes" :key="i" class="flex items-start gap-3 text-sm text-gray-700">
                                    <span class="w-1.5 h-1.5 bg-green-500 rounded-full mt-1.5 flex-shrink-0"></span>
                                    <span>{{ item }}</span>
                                </li>
                            </ul>
                        </div>
                        <div class="bg-red-50/50 p-6 rounded-2xl border border-red-100">
                            <h3 class="font-bold text-red-800 mb-4 flex items-center gap-2">
                                <i class="fas fa-times-circle"></i> Not Included
                            </h3>
                            <ul class="space-y-3">
                                <li v-for="(item, i) in tour.excludes" :key="i" class="flex items-start gap-3 text-sm text-gray-700">
                                    <span class="w-1.5 h-1.5 bg-red-400 rounded-full mt-1.5 flex-shrink-0"></span>
                                    <span>{{ item }}</span>
                                </li>
                            </ul>
                        </div>
                    </section>
                </div>

                <div class="lg:col-span-4 relative">
                    <div class="sticky top-28 max-h-[calc(100vh-130px)] overflow-y-auto custom-scrollbar pr-2 pb-4">
                        <div id="contact" 
                             :class="['bg-white rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.1)] border p-5 relative overflow-hidden transition-all duration-300', formHighlight ? 'highlight-active border-brand' : 'border-gray-100']">
                            
                            <div class="absolute top-0 left-0 w-full h-2 bg-brand"></div>
                            
                            <div v-if="isSubmitted" class="py-10 text-center fade-in">
                                <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-3xl mx-auto mb-4 animate-bounce">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Inquiry Sent!</h3>
                                <p class="text-xs text-gray-600 mb-6 leading-relaxed">
                                    We will contact you within <span class="text-brand font-bold underline">24 hours</span>.
                                </p>
                                <button @click="resetForm" class="text-brand font-bold text-xs hover:underline flex items-center gap-2 mx-auto">
                                    <i class="fas fa-redo-alt text-[10px]"></i> Submit New Inquiry
                                </button>
                            </div>

                            <form v-else class="space-y-3" @submit.prevent="handleFormSubmit" novalidate>
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h3 class="text-xl font-bold font-serif mb-1">Start Your Journey</h3>
                                        <p class="text-xs text-gray-400">Fill the form, we'll reply in 24h.</p>
                                    </div>
                                    <button type="button" @click="isTermsModalOpen = true" class="text-brand text-xs font-bold underline hover:text-red-800">
                                        <i class="fas fa-info-circle"></i> Terms & Info
                                    </button>
                                </div>

                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-[10px] font-bold text-gray-500 mb-1 ml-1 uppercase">Name *</label>
                                        <input type="text" v-model="formData.name" required placeholder="Your Name"
                                               :class="{'input-error': attemptedSubmit && !formData.name}"
                                               class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-brand transition outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-[10px] font-bold text-gray-500 mb-1 ml-1 uppercase">Passengers *</label>
                                        <input type="number" v-model.number="formData.passengers" min="1" required
                                               :class="{'input-error': attemptedSubmit && !formData.passengers}"
                                               class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-brand transition outline-none">
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-[10px] font-bold text-gray-500 mb-1 ml-1 uppercase">Phone *</label>
                                    <div class="flex gap-2">
                                        <div class="relative w-24 shrink-0">
                                            <select v-model="formData.countryCode" class="w-full pl-2 pr-5 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-brand transition text-xs appearance-none h-full">
                                                <option value="+33">ðŸ‡«ðŸ‡· +33</option>
                                                <option value="+86">ðŸ‡¨ðŸ‡³ +86</option>
                                                <option value="+852">ðŸ‡­ðŸ‡° +852</option>
                                                <option value="+44">ðŸ‡¬ðŸ‡§ +44</option>
                                                <option value="+1">ðŸ‡ºðŸ‡¸ +1</option>
                                            </select>
                                            <i class="fas fa-chevron-down absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-[10px]"></i>
                                        </div>
                                        <input type="tel" v-model="formData.phone" required placeholder="Number"
                                               :class="{'input-error': attemptedSubmit && (phoneError || !formData.phone)}"
                                               class="flex-1 w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-brand transition outline-none">
                                    </div>
                                    <p v-if="attemptedSubmit && phoneError" class="text-red-600 text-[10px] ml-1 mt-1">{{ phoneError }}</p>
                                </div>

                                <div>
                                    <label class="block text-[10px] font-bold text-gray-500 mb-1 ml-1 uppercase">Email *</label>
                                    <input type="email" v-model="formData.email" required placeholder="example@email.com"
                                           :class="{'input-error': attemptedSubmit && !formData.email}"
                                           class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-brand transition outline-none">
                                </div>

                                <div>
                                    <label class="block text-[10px] font-bold text-gray-500 mb-1 ml-1 uppercase">Date *</label>
                                    <div class="relative">
                                        <select v-model="formData.date" required 
                                                :class="{'input-error': attemptedSubmit && !formData.date}"
                                                class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:border-brand transition text-gray-700 font-medium appearance-none text-sm">
                                            <option value="" disabled>Select Date</option>
                                            <option v-for="date in tour.dates" :key="date.start" :value="date.start">{{ date.start }} ({{ date.price }})</option>
                                            <option value="other">Other Date / TBD</option>
                                        </select>
                                        <i class="fas fa-chevron-down absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-xs"></i>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-[10px] font-bold text-gray-500 mb-1 ml-1 uppercase">Optional Extras (Per Person)</label>
                                    <div class="border border-gray-200 rounded-lg overflow-hidden transition-all duration-300" :class="{'border-brand bg-red-50/30': isOptionalsOpen}">
                                        <button type="button" @click="isOptionalsOpen = !isOptionalsOpen" 
                                                class="w-full flex justify-between items-center p-3 bg-gray-50 hover:bg-gray-100 transition-colors focus:outline-none">
                                            <span class="text-xs font-medium text-gray-700">
                                                <span v-if="formData.selectedOptionals.length === 0">Click to Select</span>
                                                <span v-else class="text-brand font-bold">{{ formData.selectedOptionals.length }} Item(s) Selected</span>
                                            </span>
                                            <i class="fas fa-chevron-down text-gray-400 text-xs transform transition-transform duration-300" 
                                               :class="{'rotate-180 text-brand': isOptionalsOpen}"></i>
                                        </button>
                                        
                                        <transition name="accordion">
                                            <div v-show="isOptionalsOpen" class="bg-white border-t border-gray-100">
                                                <div class="p-2 space-y-1">
                                                    <div v-for="(item, index) in tour.optionalItems" :key="index" 
                                                         class="flex items-center justify-between p-2 rounded hover:bg-gray-50 cursor-pointer transition-colors"
                                                         @click="toggleOptionalSelection(item)">
                                                        <div class="flex items-center gap-3">
                                                            <div class="w-4 h-4 border rounded flex items-center justify-center transition-colors" 
                                                                 :class="isOptionalSelected(item) ? 'bg-brand border-brand' : 'border-gray-300 bg-white'">
                                                                <i v-if="isOptionalSelected(item)" class="fas fa-check text-white text-[10px]"></i>
                                                            </div>
                                                            <span class="text-xs text-gray-700 select-none">{{ item.name }}</span>
                                                        </div>
                                                        <span v-if="item.price > 0" class="text-xs font-bold text-gray-500 select-none">+{{ item.price }} {{ item.unit }}</span>
                                                        <span v-else class="text-xs font-bold text-gray-400 select-none">Self-pay</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </transition>
                                    </div>
                                </div>

                                <div v-if="calculatedPrice > 0" class="bg-red-50 p-3 rounded-lg border border-red-100 flex justify-between items-center">
                                    <div class="flex flex-col">
                                        <span class="text-[10px] text-red-600 font-bold uppercase">Estimated Total</span>
                                        <div class="flex flex-col">
                                            <span v-if="hasSingleSupplement" class="text-[9px] text-red-400 leading-tight">* Incl. Single Supp. {{ tour.singleSupplement }}</span>
                                            <span class="text-[9px] text-red-400 leading-tight">* Incl. Optional Items</span>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="text-lg font-bold text-brand">{{ calculatedPrice.toLocaleString() }} â‚¬</span>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-[10px] font-bold text-gray-500 mb-1 ml-1 uppercase">Remarks</label>
                                    <textarea v-model="formData.remarks" class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-brand transition h-16 outline-none resize-none" placeholder="Dietary requests, flight info, etc..."></textarea>
                                </div>

                                <button class="w-full bg-brand text-white font-bold py-3 rounded-lg hover:bg-[#991b1b] transition shadow-lg flex items-center justify-center gap-2 transform active:scale-95 text-sm">
                                    <span v-if="isSending"><i class="fas fa-spinner fa-spin"></i> Sending...</span>
                                    <span v-else>Submit Inquiry <i class="fas fa-paper-plane"></i></span>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <transition name="modal">
        <div v-if="activeOptional" class="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" @click.self="closeOptionalModal">
            <transition name="modal-content" appear>
                <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden relative">
                    <button @click="closeOptionalModal" class="absolute top-4 right-4 z-10 w-8 h-8 bg-black/30 hover:bg-black/50 text-white rounded-full flex items-center justify-center transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div class="h-56 bg-gray-200 relative">
                        <img :src="activeOptional.detailImage" class="w-full h-full object-cover">
                        <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/80 to-transparent p-6 pt-12">
                            <h3 class="text-2xl font-bold text-white">{{ activeOptional.name }}</h3>
                            <div class="text-brand font-bold text-lg mt-1">
                                <span v-if="activeOptional.price > 0">{{ activeOptional.price }} {{ activeOptional.unit }} <span class="text-white/80 text-xs font-normal">/ Person</span></span>
                                <span v-else>Self-pay</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <p class="text-gray-600 text-sm leading-relaxed mb-6">{{ activeOptional.description }}</p>
                        <button @click="closeOptionalModal" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 rounded-xl transition-colors">
                            Close
                        </button>
                    </div>
                </div>
            </transition>
        </div>
    </transition>

    <transition name="modal">
        <div v-if="isTermsModalOpen" class="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" @click.self="isTermsModalOpen = false">
            <transition name="modal-content" appear>
                <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden relative flex flex-col max-h-[80vh]">
                    <div class="p-4 border-b border-gray-100 flex justify-between items-center">
                        <h3 class="text-xl font-bold text-gray-800">Terms & Conditions</h3>
                        <button @click="isTermsModalOpen = false" class="w-8 h-8 hover:bg-gray-100 text-gray-500 rounded-full flex items-center justify-center transition-colors">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="p-6 overflow-y-auto custom-scrollbar">
                        <div class="prose prose-sm text-gray-600 text-justify leading-relaxed">
                            <p class="mb-4">
                                To maximize the protection of your interests, please carefully read our "Registration Instructions and Responsibility Details". These terms act as an important notice from our company to outbound tour members and form part of the tourism contract. Our company reserves all rights to interpret the content of this website.
                            </p>
    
                            <h4 class="font-bold text-gray-800 mt-6 mb-2">(1) Booking Process & Precautions</h4>
                            <div class="space-y-3">
                                <p>1. When booking, please fill in the booking order form on the webpage first. Please carefully fill in and verify that all information (including name, gender, ID number, contact information, required room type, etc.) is correct. The company is not responsible for any losses caused by incorrect information filled in by individuals. After successful submission, our company will send you an order confirmation. Due to limited bus seats, our company will prioritize seating based on payment arrival. We will arrange vehicles according to the final group size to ensure one seat per person. Please arrange payment within the order validity period after verifying that there are no errors. <span class="text-red-600 font-bold">Those who fail to pay the full tour fee by the deadline will be considered as automatically withdrawing, and we have the right to cancel your order without further notice.</span></p>
                
                                <p>2. Members must ensure that 100% of the tour fee is paid within the order retention period upon confirmation of the group. Since bus seats and hotel room quotas are limited, and hotel reservations often have time limits, members booking within 5 working days before departure must complete payment proactively and promptly. Otherwise, we reserve the right to retain or cancel such orders based on the specific situation without prior consent. Transaction fees for payments are borne by the payer. After payment, please send the payment proof (bank slip or online transfer screenshot) via email or fax to our company, noting the corresponding order number, otherwise finance cannot verify the payment.</p>
                
                                <p>3. After confirming receipt of payment, we will confirm your participation. Members will receive a "Joining Notice" via email 3 days before departure, containing guide info, itinerary, and pick-up/drop-off points. If you do not receive this notice 5 days before departure due to network delays or spam filters, please contact our staff immediately.</p>
                
                                <p>4. We default to same-gender room sharing. If a single traveler or an odd number of travelers (e.g., 3, 5, 7) register, we will arrange room sharing based on actual conditions. If you do not accept sharing, you may choose to pay the extra single supplement. In special cases such as peak season or insufficient rooms, room types may change, and members must cooperate. If incorrect gender or room requirements provided during booking lead to onsite discrepancies, we will coordinate based on remaining rooms, <span class="text-red-600 font-bold">and any extra costs generated will be borne by the member.</span><br>
                                <span class="bg-red-50 text-red-700 px-2 py-1 rounded inline-block mt-1 text-xs">Note: For strangers sharing a room arranged by us, the company is not responsible for personal character or behavior. Disputes or habit differences are not the responsibility of the company or guide to mediate.</span></p>
                
                                <p>5. If a member needs to leave the group midway due to special circumstances, they must proactively inform us before departure/during registration. Leaving early results in a â‚¬50 reduction per night not stayed (or â‚¬100 if a single room was booked for the whole trip). If no hotel nights are missed, there is no refund. <span class="text-red-600 font-bold">No refund is given if the request to leave is made during the tour.</span> Members must assess their own health. Expenses and losses arising from personal health issues during the trip are borne by the member. Those with serious illnesses (e.g., severe illness, terminal illness, or infectious disease) must declare them truthfully during registration. We reserve the right to accept or reject guests based on health conditions.</p>
                
                                <p>6. Members over 70 must be accompanied by a family member and sign a "Senior Travel Disclaimer". If unaccompanied and insisting on joining, we reserve the right to refuse. All consequences caused by the member's own reasons during the trip are borne by the member.</p>
                                
                                <p>7. Pregnant women must truthfully declare their status. Those over 24 weeks are generally advised not to join; if insisting, they must be accompanied by a family member and sign a disclaimer, though we reserve the right to refuse. Those under 24 weeks must also be accompanied and sign a disclaimer. Consequences caused by personal reasons during the trip are borne by the member.</p>
                
                                <p>8. Minors must be accompanied by at least one adult who fulfills guardianship duties. Consequences caused by the minor or lack of supervision are borne by the member.</p>
                
                                <p>9. Members must confirm that all provided information is accurate, especially ID and phone numbers. Consequences caused by incorrect information (e.g., expired passport, visa issues preventing border crossing, incorrect phone number preventing contact) and resulting costs (return fees, transport, etc.) are borne by the participant.</p>
                
                                <p>10. Please do not book any flight or train tickets associated with the itinerary before your order is confirmed. Losses incurred from booking transport before confirmation are borne by the applicant.</p>
                                
                                <p>11. The travel agency may terminate the contract if: (1) The member has a contagious disease endangering others; (2) Carries dangerous items; (3) Engages in illegal activities; (4) Seriously affects the rights of others and refuses to stop. In such cases, the agency will notify in writing and may deduct necessary expenses before refunding the balance.</p>
                            </div>
    
                            <h4 class="font-bold text-gray-800 mt-6 mb-2">(2) Discounts & Usage</h4>
                            <div class="space-y-3">
                                <p>1. 35% off for children under 6! <span class="text-red-600">*Note: Children do not occupy a bed. If a bed is needed, please contact us. If one adult brings one child, the child pays full price.</span></p>
                                <p>2. Single travelers can choose the room-sharing service. We will arrange same-gender sharing. Whether successful or not, we will not charge a single supplement. Note: For orders placed within 5 days of departure, we reserve the right to charge the full single supplement based on actual conditions. Free sharing service does not apply to pre/post-tour accommodation.</p>
                            </div>
    
                            <h4 class="font-bold text-gray-800 mt-6 mb-2">(3) Cancellation Policy</h4>
                            <div class="bg-gray-50 border border-gray-200 p-4 rounded-lg text-sm">
                                <p class="font-bold mb-2">1. Cancellation</p>
                                <div class="space-y-1">
                                    <p>More than 31 days before departure (inclusive): <span class="text-red-600 font-bold">5% of total order amount charged;</span></p>
                                    <p>15 to 30 days before departure (inclusive): <span class="text-red-600 font-bold">50% of total order amount charged;</span></p>
                                    <p>8 to 14 days before departure (inclusive): <span class="text-red-600 font-bold">80% of total order amount charged;</span></p>
                                    <p>Within 7 days before departure (inclusive), if vehicles/hotels are confirmed: <span class="text-red-600 font-bold">No refund (100% charged).</span></p>
                                </div>
                            </div>
    
                            <h4 class="font-bold text-gray-800 mt-6 mb-2">(4) Member Obligations</h4>
                            <div class="space-y-3">
                                <p>1. Members must not engage in illegal activities.</p>
                                <p>2. Do not harm national/social interests or the rights of others.</p>
                                <p>3. Observe public order and social morality. Respect service staff and other members; respect local customs; do not scribble on monuments, spit, or litter.</p>
                                <p>4. Improve self-protection awareness. Members can purchase personal accident insurance. Take care of luggage and valuables.</p>
                                <p>5. Pay attention to local weather and child safety.</p>
                                <p>6. <span class="text-red-600">If members voluntarily participate in high-risk activities (climbing, diving, bungee jumping, etc.), any resulting disputes, property loss, or personal injury are the member's responsibility.</span></p>
                            </div>
    
                            <h4 class="font-bold text-gray-800 mt-6 mb-2">(5) Liability Details</h4>
                            <div class="space-y-3">
                                <p>1. We reserve the right to change accommodation, routes, attractions, and dates based on specific circumstances.</p>
                                <p>2. If cancellation occurs due to insufficient numbers or transport issues beyond our control, we reserve the right to change or cancel. We will refund the full amount or recommend alternatives, but <span class="text-red-600 font-bold">we are not liable for further compensation.</span></p>
                                <p>3. In case of force majeure (natural disasters, war, strikes, riots, weather, etc.), we may cancel/alter the itinerary or shorten/extend the trip. We will notify members in advance. <span class="text-red-600 font-bold">Extra costs or losses are not our responsibility, and members cannot object or withdraw for this reason.</span></p>
                                <p>4. Due to varying security in different countries, please pay attention to personal safety and property. <span class="text-red-600 font-bold">We are not legally responsible for loss, theft, or robbery.</span> Please report to the guide and police immediately.</p>
                                <p>5. Members must carry valid passports/visas. Losses caused by document issues are the member's responsibility (no refund). Members bear liability if this affects others.</p>
                                <p>6. Accidents (injury/death/property loss) during the trip due to personal reasons or violation of rules are the member's responsibility. We are not liable. Members must compensate if they cause loss to the company.</p>
                                <p>7. The guide may disqualify members who intentionally violate rules or hinder the group, without refund.</p>
                                <p>8. Times listed are references. Actual times vary due to weather, traffic, etc. Please allow at least 3 hours buffer for connecting transport. We are not responsible for missed connections due to lack of buffer time.</p>
                            </div>
    
                            <h4 class="font-bold text-gray-800 mt-6 mb-2">(6) Overseas Travel Safety & Notes</h4>
                            <div class="space-y-4">
                                <div>
                                    <h5 class="font-bold text-gray-700 mb-1">I. Tips</h5>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li>Plug standards vary across Europe (e.g., Italy/Switzerland differ from Germany). Bring adapters.</li>
                                        <li>Children must occupy a seat regardless of age. Most buses don't have child seats; bring your own if needed (must occupy one seat).</li>
                                    </ul>
                                </div>
        
                                <div>
                                    <h5 class="font-bold text-gray-700 mb-1">II. Safety</h5>
                                    <p class="font-bold text-brand mt-2">[Clothing]</p>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li>European weather changes; bring rain gear and jackets.</li>
                                        <li>Label luggage clearly. Report lost luggage to hotels/airlines/police immediately.</li>
                                    </ul>
        
                                    <p class="font-bold text-brand mt-2">[Food]</p>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li>Hotel breakfasts are typically simple (bread, coffee, juice). We arrange hotels with buffet breakfast.</li>
                                        <li>Bring water and dry food, especially for kids/seniors.</li>
                                        <li>Do not drink unclean water or accept food from strangers.</li>
                                        <li>Bring necessary medication. We do not provide alcohol; limit your intake.</li>
                                    </ul>
        
                                    <p class="font-bold text-brand mt-2">[Accommodation]</p>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li>European city hotels are often smaller and older than in the US/China.</li>
                                        <li>Toothbrushes, toothpaste, and slippers are usually not provided. Bring your own.</li>
                                        <li>Check room supplies upon entry. Report damages immediately.</li>
                                        <li>Many hotels do not have A/C due to history/climate.</li>
                                        <li>In Italy/Spain, blankets are often in the closet.</li>
                                        <li>Bring a small hairdryer if needed.</li>
                                        <li>Double beds are often two single mattresses pushed together.</li>
                                        <li><span class="text-red-600 font-bold">Do not leave valuables in the room.</span></li>
                                        <li>No smoking in rooms (fines are paid by the violator). Lock doors.</li>
                                    </ul>
        
                                    <p class="font-bold text-brand mt-2">[Transport]</p>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li>Pick-up/drop-off times are estimates. Locations are subject to confirmation.</li>
                                        <li>Limit luggage due to bus space. We ensure one seat per person.</li>
                                        <li>Bus stops may be a distance from attractions to avoid congestion.</li>
                                        <li>No smoking on the bus. No dangerous items. Follow guide instructions.</li>
                                        <li>Close windows and take valuables when leaving the bus. We are not responsible for theft.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 border-t border-gray-100 bg-gray-50">
                        <button @click="isTermsModalOpen = false" class="w-full bg-brand hover:bg-[#991b1b] text-white font-bold py-3 rounded-xl transition-colors">
                            I Have Read and Understood
                        </button>
                    </div>
                </div>
            </transition>
        </div>
    </transition>

    <footer class="bg-[#111] text-gray-400 pt-20 pb-10 border-t border-gray-800">
        <div class="container mx-auto px-6 lg:px-12">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-16 mb-20">
                <div class="space-y-8">
                    <div class="inline-block bg-white p-3 rounded-md shadow-sm">
                        <img src="https://www.eurasia-tours.fr/assets/logo-word-rNz8dsz6.jpg" alt="Eurasia Tours" class="h-10 w-auto object-contain">
                    </div>
                    <p class="text-sm leading-relaxed font-light">Since 2000, creating bespoke journeys that bridge cultures. Your trusted partner for authentic travel experiences across Europe and Asia.</p>
                </div>
                
                <div>
                    <h4 class="text-white font-serif text-lg mb-6">Accreditations</h4>
                    <ul class="space-y-4 text-sm font-light">
                        <li class="flex items-center gap-3"><i class="fas fa-certificate text-gray-600"></i> APST France Member</li>
                        <li class="flex items-center gap-3"><i class="fas fa-plane text-gray-600"></i> IATA Accredited Agent</li>
                        <li class="flex items-center gap-3"><i class="fas fa-shield-alt text-gray-600"></i> RCP Insurance Coverage</li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-white font-serif text-lg mb-6">Paris Headquarters</h4>
                    <ul class="space-y-4 text-sm font-light">
                        <li class="flex items-start gap-3"><i class="fas fa-map-marker-alt text-gray-600 mt-1"></i> 30 Rue Ernest Renan, 75015 Paris</li>
                        <li class="flex items-center gap-3"><i class="fas fa-phone text-gray-600"></i> +33 (0)1 56 69 12 80</li>
                        <li class="flex items-center gap-3"><i class="fas fa-envelope text-gray-600"></i> contact@eurasiatours.fr</li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-white font-serif text-lg mb-6">Connect</h4>
                    <div class="flex gap-4 mb-8">
                        <div class="relative group" @mouseenter="isWechatQR = true" @mouseleave="isWechatQR = false">
                            <a href="#" class="w-10 h-10 border border-gray-700 rounded-full flex items-center justify-center hover:bg-[#07C160] hover:border-[#07C160] hover:text-white transition-all">
                                <i class="fab fa-weixin"></i>
                            </a>
                            <transition name="qr-fade">
                                <div v-if="isWechatQR" class="absolute bottom-14 left-1/2 -translate-x-1/2 bg-white p-2 rounded shadow-xl z-50 w-32">
                                    <img src="https://www.eurasia-tours.fr/assets/wechat-account-VZcww6ek.jpg" class="w-full">
                                </div>
                            </transition>
                        </div>
                        <div class="relative group" @mouseenter="isFacebookQR = true" @mouseleave="isFacebookQR = false">
                            <a href="#" class="w-10 h-10 border border-gray-700 rounded-full flex items-center justify-center hover:bg-[#1877F2] hover:border-[#1877F2] hover:text-white transition-all">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <transition name="qr-fade">
                                <div v-if="isFacebookQR" class="absolute bottom-14 left-1/2 -translate-x-1/2 bg-white p-2 rounded shadow-xl z-50 w-32">
                                    <img src="https://www.eurasia-tours.fr/assets/3-Bjf7LFHD.png" class="w-full">
                                </div>
                            </transition>
                        </div>
                    </div>
                    <div class="flex gap-3 text-2xl opacity-20">
                        <i class="fab fa-cc-visa"></i><i class="fab fa-cc-mastercard"></i><i class="fab fa-cc-amex"></i>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-800 pt-8 flex flex-col md:flex-row justify-between items-center text-xs tracking-widest uppercase text-gray-600">
                <p>&copy; 2026 Eurasia Tours. All Rights Reserved.</p>
                <div class="flex gap-6 mt-4 md:mt-0">
                    <a href="#" class="hover:text-white transition">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>
</div>

<script>
    const { createApp, ref, reactive, computed, nextTick, onMounted } = Vue;

    createApp({
        setup() {
            onMounted(() => {
                setInterval(nextSlide, 5000);
                
                let isScrolling = false;
                window.addEventListener('scroll', () => {
                    if (!isScrolling) {
                        window.requestAnimationFrame(() => {
                            handleScroll();
                            isScrolling = false;
                        });
                        isScrolling = true;
                    }
                });
            });

            // HEADER STATE
            const isMobileMenuOpen = ref(false);
            const isDestDropdownOpen = ref(false);
            const isLangDropdownOpen = ref(false);
            const isWechatQR = ref(false);
            const isFacebookQR = ref(false);
            const currentLang = ref('English');

            // Header Links
            const navLinks = [
                { name: 'Home', url: 'index-en.html' },
                { 
                    name: 'Destinations', 
                    url: 'destination-europe-en.html', 
                    subLinks: [
                        { name: 'Asia', url: 'destination-asia-en.html' },
                        { name: 'Europe', url: 'destination-europe-en.html' }
                    ] 
                },
                { name: 'Tailor-made', url: 'custom-en.html' },
                { name: 'Flight Services', url: 'flight-tickets-en.html' },
                { name: 'About Us', url: 'about-en.html' },
                { name: 'Contact Us', url: 'contact-en.html' },
                { name: 'Blog', url: 'blog-en.html' }
            ];

            // Language Switcher Logic
            const switchLang = (lang) => {
                const urlMap = {
                    'ä¸­æ–‡': 'spain-portugal-indepth-tour-11-days.html',
                    'English': 'spain-portugal-indepth-tour-11-days-en.html',
                    'FranÃ§aise': 'destination-main-fr.html'
                };
                const targetUrl = urlMap[lang];
                if (targetUrl) {
                    window.location.href = targetUrl;
                }
            };

            // PAGE LOGIC
            const activeSection = ref('dates');
            const subMenu = [
                { name: 'Dates & Prices', id: 'dates' },
                { name: 'Highlights', id: 'overview' },
                { name: 'Map', id: 'map' },
                { name: 'Itinerary', id: 'itinerary' },
                { name: 'Optionals', id: 'optionals' },
                { name: 'Included', id: 'includes' },
            ];

            // CAROUSEL
            const currentHeroIndex = ref(0);
            const heroImages = [
                'images/spain-portugal-indepth-tour-11-days/header-1.jpg', 
                'images/spain-portugal-indepth-tour-11-days/header-2.jpg', 
                'images/spain-portugal-indepth-tour-11-days/header-3.jpg' 
            ];
            const nextSlide = () => {
                currentHeroIndex.value = (currentHeroIndex.value + 1) % heroImages.length;
            };
            const prevSlide = () => {
                currentHeroIndex.value = (currentHeroIndex.value - 1 + heroImages.length) % heroImages.length;
            };

            // MODALS
            const activeOptional = ref(null);
            const openOptionalModal = (item) => { activeOptional.value = item; };
            const closeOptionalModal = () => { activeOptional.value = null; };
            const isTermsModalOpen = ref(false);

            // TOUR DATA (Translated from Spain/Portugal tour)
            const tour = reactive({
                title: '2026 Spain & Portugal In-Depth Tour',
                subTitle: '11 Days / 10 Nights (Iberian Peninsula)',
                highlights: [
                    'City of Gaudi: Barcelona\'s Sagrada Familia & Casa Mila',
                    'Madrid: Royal luxury & Puerta del Sol vitality',
                    'Cabo da Roca: "Where the land ends and the sea begins"',
                    'Alhambra Palace: The red castle left by the Moors',
                    'Seville: Plaza de EspaÃ±a & the passion of Flamenco',
                    'Porto: Wine aroma & blue tiles by the Douro River',
                    'Ronda: White town on the cliffs & bullring'
                ],
                singleSupplement: '650 â‚¬', 
                
                optionalItems: [
                    { 
                        id: 1,
                        name: 'Flamenco Show', 
                        price: 60, 
                        unit: 'â‚¬',
                        currency: 'EUR',
                        shortDesc: 'The essence of Spain, experience passionate dance.',
                        description: 'You haven\'t truly been to Spain without seeing Flamenco. This is not just a dance performance, but a deep exploration of the Andalusian cultural soul. Amidst the rapid strumming of guitars and the desolate singing, feel the passionate rhythm struck by the dancers\' heels and the love and hate under the flying skirts up close. We select professional venues with great local reputations, allowing you to immerse yourself in this art treasure listed as an Intangible Cultural Heritage of Humanity.',
                        detailImage: 'images/spain-portugal-indepth-tour-11-days/extra-1.jpg'
                    },
                    { 
                        id: 2,
                        name: 'Seafood Meal (Spain/Portugal)', 
                        price: 30, 
                        unit: 'â‚¬',
                        currency: 'EUR',
                        shortDesc: 'Taste authentic local seafood flavors.',
                        description: 'Relying on the long coastline, Spain and Portugal have unique marine resources. We will take you to local specialty restaurants to enjoy a sumptuous seafood feast. Strictly selecting fresh ingredients caught on the day, whether it is Portuguese-style stew or Western-style iron plate grilling, we strive to retain the most authentic sweet taste of seafood. Reward your taste buds with a meal full of color, aroma, and taste, letting the flavors of the Atlantic and Mediterranean collide perfectly on your tongue. (Specific dishes depend on season and supply).',
                        detailImage: 'images/spain-portugal-indepth-tour-11-days/extra-2.jpg'
                    }
                ],
                
                dates: [
                    { start: '14/02/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '04/04/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '01/05/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '06/06/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '11/07/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '25/07/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '08/08/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '22/08/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '12/09/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '01/10/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '24/10/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '14/11/2026', price: '1295 â‚¬', guaranteed: true },
                    { start: '22/12/2026', price: '1295 â‚¬', guaranteed: true }
                ],
                
                includes: [
                    'Hotel: Local 3-star hotel double room (as listed in itinerary)',
                    'Transport: Tourist bus or business van (arranged based on group size)',
                    'Driver/Guide: Professional bus driver + Chinese speaking guide or Driver-Guide',
                    'Meals: Hotel breakfast',
                    'Luggage: 1 piece 23kg luggage and 1 carry-on per person'
                ],
                excludes: [
                    'Attraction entrance tickets listed in the itinerary',
                    'Driver and Guide tips: 10â‚¬ per person per day (Total 110â‚¬), same for children',
                    'Mandatory Fee: 30â‚¬/person (City entry fees & taxes. â‰¥12yo full price; 6-11yo half price; â‰¤5yo free)',
                    'Single Supplement: 650â‚¬ (Only for those unwilling to share room; double if bought on tour)',
                    'Lunch & Dinner: Guide will recommend, optional choice',
                    'Optional Extras: Flamenco 60â‚¬/p; Seafood Lunch Buffet 25-30â‚¬/p; Seafood Meal 25-30â‚¬/p',
                    'Personal Travel Insurance',
                    'Losses due to force majeure (weather, strikes, etc.)',
                    'Personal expenses in hotel (phone, laundry, etc.) & items not mentioned in "Included"'
                ],

                daysData: [
                    { 
                        day: 1, 
                        title: 'Barcelona â€“ Zaragoza â€“ Madrid', 
                        transport: 'Bus', 
                        content: 'Gather in Barcelona at 8:30 AM, then proceed to Zaragoza to visit the <b>Basilica of Our Lady of the Pillar</b>, a Baroque architectural gem and important pilgrimage site with 11 colorful tiled domes. Visit the <b>AljaferÃ­a Palace</b>, an 11th-century Islamic palace known as the "Alhambra of Spain", witnessing the history of the Reconquista. Afterwards, proceed to Madrid.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-1.jpg', 
                        hotel: 'Madrid or nearby hotel', 
                        meals: 'Breakfast: Self-arranged',
                        isOpen: true 
                    },
                    { 
                        day: 2, 
                        title: 'Madrid â€“ Toledo â€“ Salamanca', 
                        transport: 'Bus', 
                        content: 'In the morning, visit <b>Las Ventas Bullring</b>, then tour the <b>Royal Palace of Madrid</b> (Optional), the third largest in Europe, famous for its luxurious interior and collections. Visit <b>Puerta del Sol</b>, the center of Madrid, and admire the Post Office building. Visit <b>Plaza Mayor</b> and <b>Gran VÃ­a</b> to feel the vibrant rhythm of Madrid. <br>After Madrid, head to the ancient city of <b>Toledo</b>, a UNESCO site influenced by Christian, Muslim, and Jewish cultures. Admire the <b>Toledo Cathedral</b> (Exterior), a Gothic masterpiece. Proceed to Salamanca.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-2.jpg',
                        hotel: 'Salamanca or nearby hotel',
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 3, 
                        title: 'Salamanca â€“ Porto', 
                        transport: 'Bus', 
                        content: 'Depart for <b>Porto</b>, Portugal. Famous for its wine and diverse history. Walk through the old town to <b>Ribeira Square</b>, enjoy the Atlantic breeze at the pier, and view the <b>Dom LuÃ­s I Bridge</b> and traditional Rabelo boats. Visit the exterior of <b>Porto Cathedral</b> and the iconic <b>ClÃ©rigos Tower</b>.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-3.jpg',
                        hotel: 'Porto or nearby hotel', 
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 4, 
                        title: 'Porto â€“ Coimbra', 
                        transport: 'Bus', 
                        content: 'Travel to Coimbra. Visit the <b>University of Coimbra</b>, scattered throughout the hill town. Visit the magnificent <b>Joanina Library</b> (Optional), a "Temple of Books" with gold leaf decorations and Chinese lacquer shelves (Note: Absolute silence required). Visit the <b>Old Cathedral of Coimbra</b>, a 12th-century Romanesque building.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-4.jpg',
                        hotel: 'Coimbra or nearby hotel',
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 5, 
                        title: 'Coimbra â€“ Sintra â€“ Cabo da Roca â€“ Lisbon', 
                        transport: 'Bus', 
                        content: 'Head to <b>Sintra</b>, famous for its palaces. See the <b>National Palace of Sintra</b> with its iconic twin conical chimneys. Drive along the cliffs to <b>Cabo da Roca</b>, the westernmost point of continental Europe ("Where the land ends and the sea begins"). Pass through the seaside resort of <b>Cascais</b> on the way to Lisbon.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-5.jpg',
                        hotel: 'Lisbon or nearby hotel', 
                        meals: 'Breakfast: In Hotel',
                        isOpen: false
                    },
                    { 
                        day: 6, 
                        title: 'Lisbon â€“ Seville', 
                        transport: 'Bus', 
                        content: 'Tour Lisbon\'s highlights: The majestic <b>25 de Abril Bridge</b> (resembling the Golden Gate), the Manueline-style <b>JerÃ³nimos Monastery</b>, the historic <b>BelÃ©m Tower</b>, and the <b>Monument to the Discoveries</b>. Enjoy Portuguese egg tarts before driving to Seville.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-6.jpg',
                        hotel: 'Seville or nearby hotel', 
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 7, 
                        title: 'Seville â€“ Cordoba', 
                        transport: 'Bus', 
                        content: 'Seville embodies the Golden Age. Visit the magnificent <b>Plaza de EspaÃ±a</b> with its tiled alcoves. Optional visits to the <b>Seville Cathedral</b> (world\'s largest Gothic church) and the <b>Royal AlcÃ¡zar of Seville</b>. Proceed to <b>Cordoba</b>. Walk on the <b>Roman Bridge</b>, visit the <b>Calleja de las Flores</b> (Alley of Flowers), and see the <b>Mosque-Cathedral of Cordoba</b>.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-7.jpg',
                        hotel: 'Cordoba or nearby hotel',
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 8, 
                        title: 'Cordoba â€“ Ronda â€“ Mijas â€“ Granada', 
                        transport: 'Bus', 
                        content: 'Travel south to <b>Ronda</b>, the cliffside city. See the <b>Puente Nuevo</b> (New Bridge) spanning the deep gorge and the historic <b>Bullring</b> (origin of modern bullfighting). Continue to the "White Town" of <b>Mijas</b> for a leisurely afternoon, visiting the <b>Shrine of the Virgin of the Rock</b>. Head to Granada for the night.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-8.jpg',
                        hotel: 'Granada or nearby hotel',
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 9, 
                        title: 'Granada â€“ Valencia', 
                        transport: 'Bus', 
                        content: 'Visit the <b>Alhambra Palace</b> (Optional), the "Red Castle" and a masterpiece of Islamic art in Europe, a UNESCO World Heritage site. Explore the Generalife gardens. Afterwards, depart for Valencia.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-9.jpg',
                        hotel: 'Valencia or nearby hotel',
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 10, 
                        title: 'Valencia â€“ Barcelona', 
                        transport: 'Bus', 
                        content: 'Valencia is famous for citrus trees and Paella. It has a relaxed vibe. Visit the <b>Town Hall Square</b>, the <b>City of Arts and Sciences</b> (modern architecture), and the <b>Plaza de la Virgen</b>. Afterwards, head to Barcelona.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-10.jpg',
                        hotel: 'Barcelona or nearby hotel',
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    },
                    { 
                        day: 11, 
                        title: 'Barcelona', 
                        transport: 'Bus', 
                        content: 'A day in the city of Gaudi. <br><b>Park GÃ¼ell</b> (Optional): A garden complex with architectural elements, showcasing Gaudi\'s naturalistic style. <br><b>Sagrada Familia</b> (Optional): Gaudi\'s unfinished masterpiece, famous for its organic forms and tall spires. <br><b>Casa MilÃ  (La Pedrera)</b> (Optional): Known for its wavy stone facade and twisted iron balconies. <br><b>Columbus Monument</b>: Marking the spot where Columbus returned to Spain. <br>End of tour.', 
                        image: 'images/spain-portugal-indepth-tour-11-days/day-11.jpg',
                        hotel: 'Self-arranged',
                        meals: 'Breakfast: In Hotel',
                        isOpen: false 
                    }
                ]
            });

            // FORM LOGIC
            const formHighlight = ref(false);
            const isSubmitted = ref(false);
            const attemptedSubmit = ref(false);
            const isOptionalsOpen = ref(false); 
            const isSending = ref(false);
            const formData = reactive({
                name: '',
                countryCode: '+33',
                phone: '',
                email: '',
                date: '', 
                passengers: 2,
                selectedOptionals: [], 
                remarks: ''
            });

            const phoneError = computed(() => {
                if (!formData.phone) return null;
                const lengths = { '+33': 10, '+86': 11, '+852': 8, '+44': 10, '+1': 10 };
                const required = lengths[formData.countryCode] || 10;
                return formData.phone.length !== required ? `Number must be ${required} digits` : null;
            });

            const calculatedPrice = computed(() => {
                if (!formData.date || !formData.passengers) return 0;
                const dateObj = tour.dates.find(d => d.start === formData.date);
                if (!dateObj) return 0;
                
                const pricePerPerson = parseInt(dateObj.price.replace(/\D/g, ''));
                let total = pricePerPerson * formData.passengers;

                const singleSupplement = parseInt(tour.singleSupplement.replace(/\D/g, ''));
                if (formData.passengers % 2 !== 0) {
                    total += singleSupplement;
                }

                const optionalsTotal = formData.selectedOptionals
                    .reduce((sum, item) => sum + item.price, 0) * formData.passengers;
                
                total += optionalsTotal;
                return total;
            });

            const hasSingleSupplement = computed(() => formData.passengers % 2 !== 0);

            const toggleOptionalSelection = (item) => {
                const index = formData.selectedOptionals.findIndex(opt => opt.id === item.id);
                if (index > -1) formData.selectedOptionals.splice(index, 1);
                else formData.selectedOptionals.push(item);
            };
            const isOptionalSelected = (item) => formData.selectedOptionals.some(opt => opt.id === item.id);

            const handleBookingScroll = (date = '') => {
                if (date) formData.date = date;
                const element = document.getElementById('contact');
                if (element) {
                    const offset = 180;
                    const bodyRect = document.body.getBoundingClientRect().top;
                    const elementRect = element.getBoundingClientRect().top;
                    const elementPosition = elementRect - bodyRect;
                    const offsetPosition = elementPosition - offset;
                    window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
                    
                    formHighlight.value = true;
                    setTimeout(() => { formHighlight.value = false; }, 3000);
                }
            };

            const handleFormSubmit = async () => {
                attemptedSubmit.value = true;
                const hasEmpty = !formData.name || !formData.phone || !formData.email || !formData.date || !formData.passengers;
                if (hasEmpty || phoneError.value) {
                    nextTick(() => {
                        const firstError = document.querySelector('.input-error');
                        if (firstError) firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    });
                    return;
                }

                isSending.value = true;
                const payload = {
                    tourName: tour.title,
                    name: formData.name,
                    email: formData.email,
                    phone: formData.countryCode + " " + formData.phone,
                    travelDate: formData.date,
                    passengers: formData.passengers,
                    selectedOptionals: formData.selectedOptionals.map(item => item.name),
                    totalPrice: calculatedPrice.value, 
                    remarks: formData.remarks || ""
                };

                try {
                    // Production Logic: Send to server API
                    const response = await fetch('/api/submit-inquiry', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.ok) {
                        isSending.value = false;
                        isSubmitted.value = true;
                    } else {
                        throw new Error('Server responded with error');
                    }
                } catch (error) {
                    console.error('Submission error:', error);
                    isSending.value = false;
                    // For demo purposes/fallback if API doesn't exist in test env:
                    alert("Submission failed (API not found in this demo). Please contact us directly.");
                }
            };

            const resetForm = () => {
                isSubmitted.value = false;
                attemptedSubmit.value = false;
                formData.date = '';
                formData.passengers = 2;
                formData.selectedOptionals = [];
                formData.remarks = '';
            };

            // Toggle Logic
            const isAllExpanded = ref(false);
            const toggleDay = (index) => { tour.daysData[index].isOpen = !tour.daysData[index].isOpen; };
            const toggleAllDays = () => {
                isAllExpanded.value = !isAllExpanded.value;
                tour.daysData.forEach(day => { day.isOpen = isAllExpanded.value; });
            };

            const handleScroll = () => {
                const scrollPosition = window.scrollY + 250;
                subMenu.forEach(section => {
                    const element = document.getElementById(section.id);
                    if (element && element.offsetTop <= scrollPosition) {
                        activeSection.value = section.id;
                    }
                });
            };
            
            return {
                isMobileMenuOpen, isDestDropdownOpen, isLangDropdownOpen, currentLang, switchLang,
                isWechatQR, isFacebookQR,
                navLinks, subMenu, activeSection, 
                heroImages, currentHeroIndex, nextSlide, prevSlide,
                tour, 
                toggleDay, toggleAllDays, isAllExpanded,
                formData, formHighlight, handleBookingScroll, handleFormSubmit, 
                phoneError, attemptedSubmit, isSubmitted, resetForm, calculatedPrice, hasSingleSupplement,
                activeOptional, openOptionalModal, closeOptionalModal,
                isOptionalsOpen, toggleOptionalSelection, isOptionalSelected,
                isSending, isTermsModalOpen
            };
        }
    }).mount('#app');
</script>
</body>
</html>